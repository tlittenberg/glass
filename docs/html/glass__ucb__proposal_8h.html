<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GLASS: ucb/src/glass_ucb_proposal.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="GLASS.png"/></td>
  <td id="projectalign">
   <div id="projectname">GLASS
   </div>
   <div id="projectbrief">Global LISA Analysis Software Suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('glass__ucb__proposal_8h.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">glass_ucb_proposal.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Functions supporting proposal distributions.  
<a href="#details">More...</a></p>

<p><a href="glass__ucb__proposal_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structProposal.html">Proposal</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prototype structure for proposal distributions.  <a href="structProposal.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:addf5ec070e9499d36b7f2009ce736076" id="r_addf5ec070e9499d36b7f2009ce736076"><td class="memItemLeft" align="right" valign="top"><a id="addf5ec070e9499d36b7f2009ce736076" name="addf5ec070e9499d36b7f2009ce736076"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UNUSED</b></td></tr>
<tr class="separator:addf5ec070e9499d36b7f2009ce736076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50357902a04d93db6957d600d3b52561" id="r_a50357902a04d93db6957d600d3b52561"><td class="memItemLeft" align="right" valign="top"><a id="a50357902a04d93db6957d600d3b52561" name="a50357902a04d93db6957d600d3b52561"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>UCB_PROPOSAL_NPROP</b>&#160;&#160;&#160;9</td></tr>
<tr class="memdesc:a50357902a04d93db6957d600d3b52561"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of defined proposal distributions for UCB sampler. <br /></td></tr>
<tr class="separator:a50357902a04d93db6957d600d3b52561"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a56cc6d95dba3a4ce604e9e5648822715" id="r_a56cc6d95dba3a4ce604e9e5648822715"><td class="memItemLeft" align="right" valign="top"><a id="a56cc6d95dba3a4ce604e9e5648822715" name="a56cc6d95dba3a4ce604e9e5648822715"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup_frequency_proposal</b> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags)</td></tr>
<tr class="memdesc:a56cc6d95dba3a4ce604e9e5648822715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute whitened power spectrum of data and normalize to preferentially draw frequencies with excess power. <br /></td></tr>
<tr class="separator:a56cc6d95dba3a4ce604e9e5648822715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00cf75a9c0fa7e890be8262907e76282" id="r_a00cf75a9c0fa7e890be8262907e76282"><td class="memItemLeft" align="right" valign="top"><a id="a00cf75a9c0fa7e890be8262907e76282" name="a00cf75a9c0fa7e890be8262907e76282"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>print_acceptance_rates</b> (struct <a class="el" href="structProposal.html">Proposal</a> **proposal, int NProp, int ic, FILE *fptr)</td></tr>
<tr class="memdesc:a00cf75a9c0fa7e890be8262907e76282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute and print acceptance ratios for each proposal. <br /></td></tr>
<tr class="separator:a00cf75a9c0fa7e890be8262907e76282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0f672b1d0d0da33600eaf9d653169f" id="r_a3e0f672b1d0d0da33600eaf9d653169f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3e0f672b1d0d0da33600eaf9d653169f">draw_from_prior</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a3e0f672b1d0d0da33600eaf9d653169f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fair draw from prior for each parameter.  <br /></td></tr>
<tr class="separator:a3e0f672b1d0d0da33600eaf9d653169f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33b2ee05338e6ddfa81600df5958407c" id="r_a33b2ee05338e6ddfa81600df5958407c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a33b2ee05338e6ddfa81600df5958407c">draw_from_gmm_prior</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a33b2ee05338e6ddfa81600df5958407c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fair draw from gaussian mixture model prior for each parameter.  <br /></td></tr>
<tr class="separator:a33b2ee05338e6ddfa81600df5958407c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a915c8e096a29abba968df33c1fd7ba35" id="r_a915c8e096a29abba968df33c1fd7ba35"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a915c8e096a29abba968df33c1fd7ba35">draw_from_uniform_prior</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a915c8e096a29abba968df33c1fd7ba35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fair draw from uniform ranges for each parameter.  <br /></td></tr>
<tr class="separator:a915c8e096a29abba968df33c1fd7ba35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a032470ab77fdc9e149c9e47b83772677" id="r_a032470ab77fdc9e149c9e47b83772677"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a032470ab77fdc9e149c9e47b83772677">draw_from_extrinsic_prior</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a032470ab77fdc9e149c9e47b83772677"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fair draw from prior for location and orientation parameters.  <br /></td></tr>
<tr class="separator:a032470ab77fdc9e149c9e47b83772677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f62a5a745043ab5438665afd3d5696b" id="r_a4f62a5a745043ab5438665afd3d5696b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f62a5a745043ab5438665afd3d5696b">draw_from_fisher</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a4f62a5a745043ab5438665afd3d5696b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jump from current location along eigenvectors of Fisher information matrix.  <br /></td></tr>
<tr class="separator:a4f62a5a745043ab5438665afd3d5696b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa7809385eb6fce342c65b98636adc3" id="r_adaa7809385eb6fce342c65b98636adc3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adaa7809385eb6fce342c65b98636adc3">draw_from_cdf</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:adaa7809385eb6fce342c65b98636adc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw each parameter from 1D marginalized CDF.  <br /></td></tr>
<tr class="separator:adaa7809385eb6fce342c65b98636adc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7614272d932edceadfe55ad627c628d" id="r_ab7614272d932edceadfe55ad627c628d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab7614272d932edceadfe55ad627c628d">draw_from_cov</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:ab7614272d932edceadfe55ad627c628d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw from multivariate Gaussian characterized by chain covariance.  <br /></td></tr>
<tr class="separator:ab7614272d932edceadfe55ad627c628d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3152614fb3711c8cbe2096aad5f034c6" id="r_a3152614fb3711c8cbe2096aad5f034c6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3152614fb3711c8cbe2096aad5f034c6">draw_from_fstatistic</a> (struct <a class="el" href="structData.html">Data</a> *data, UNUSED struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a3152614fb3711c8cbe2096aad5f034c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw from 3D F-statistic distribution.  <br /></td></tr>
<tr class="separator:a3152614fb3711c8cbe2096aad5f034c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8162c698145d2a045bc76d3be0f29359" id="r_a8162c698145d2a045bc76d3be0f29359"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8162c698145d2a045bc76d3be0f29359">draw_from_spectrum</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a8162c698145d2a045bc76d3be0f29359"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw \(f_0\) weighted by power spectrum of data.  <br /></td></tr>
<tr class="separator:a8162c698145d2a045bc76d3be0f29359"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ffea32458788a4cdda74d645c31b15c" id="r_a1ffea32458788a4cdda74d645c31b15c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1ffea32458788a4cdda74d645c31b15c">fm_shift</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a1ffea32458788a4cdda74d645c31b15c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shift \(f_0\) by orbital modulation frequency.  <br /></td></tr>
<tr class="separator:a1ffea32458788a4cdda74d645c31b15c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f29a876611fbc4cffca0393f565ae10" id="r_a4f29a876611fbc4cffca0393f565ae10"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4f29a876611fbc4cffca0393f565ae10">psi_phi_jump</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, UNUSED struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a4f29a876611fbc4cffca0393f565ae10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jumps between modes in \(\psi\)&ndash; \(\varphi_0\) plane.  <br /></td></tr>
<tr class="separator:a4f29a876611fbc4cffca0393f565ae10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf08661b50078f28351cbe2f6371a0ec" id="r_aaf08661b50078f28351cbe2f6371a0ec"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaf08661b50078f28351cbe2f6371a0ec">jump_from_fstatistic</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:aaf08661b50078f28351cbe2f6371a0ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same as <a class="el" href="#a3152614fb3711c8cbe2096aad5f034c6" title="Draw from 3D F-statistic distribution.">draw_from_fstatistic()</a> with <a class="el" href="#a1ffea32458788a4cdda74d645c31b15c" title="Shift  by orbital modulation frequency.">fm_shift()</a>  <br /></td></tr>
<tr class="separator:aaf08661b50078f28351cbe2f6371a0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a68e9374060cfd9ab81ea8129c9bc4b" id="r_a7a68e9374060cfd9ab81ea8129c9bc4b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7a68e9374060cfd9ab81ea8129c9bc4b">draw_from_galaxy_prior</a> (struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structPrior.html">Prior</a> *prior, double *params, unsigned int *seed)</td></tr>
<tr class="memdesc:a7a68e9374060cfd9ab81ea8129c9bc4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Draw sky location from galaxy prior defined in set_galaxy_prior()  <br /></td></tr>
<tr class="separator:a7a68e9374060cfd9ab81ea8129c9bc4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00517700cc54a08f45110c55a73acfe" id="r_ac00517700cc54a08f45110c55a73acfe"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac00517700cc54a08f45110c55a73acfe">draw_calibration_parameters</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, unsigned int *seed)</td></tr>
<tr class="memdesc:ac00517700cc54a08f45110c55a73acfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fair draw on phase and amplitude calibration parameters.  <br /></td></tr>
<tr class="separator:ac00517700cc54a08f45110c55a73acfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5299553c610fa57fe95527a5df181f22" id="r_a5299553c610fa57fe95527a5df181f22"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5299553c610fa57fe95527a5df181f22">cdf_density</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, UNUSED double *params)</td></tr>
<tr class="memdesc:a5299553c610fa57fe95527a5df181f22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate probability density from CDF.  <br /></td></tr>
<tr class="separator:a5299553c610fa57fe95527a5df181f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48c97df4de6815daf57b7f054092a035" id="r_a48c97df4de6815daf57b7f054092a035"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a48c97df4de6815daf57b7f054092a035">cov_density</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params)</td></tr>
<tr class="memdesc:a48c97df4de6815daf57b7f054092a035"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate probability density of multimode, multivariate Gaussians given covariance matrices of each Gaussian and relative weights between them.  <br /></td></tr>
<tr class="separator:a48c97df4de6815daf57b7f054092a035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ddfd1bbd97d07e4613528ed8fab7fd1" id="r_a3ddfd1bbd97d07e4613528ed8fab7fd1"><td class="memItemLeft" align="right" valign="top"><a id="a3ddfd1bbd97d07e4613528ed8fab7fd1" name="a3ddfd1bbd97d07e4613528ed8fab7fd1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initialize_proposal</b> (struct <a class="el" href="structOrbit.html">Orbit</a> *orbit, struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structPrior.html">Prior</a> *prior, struct <a class="el" href="structChain.html">Chain</a> *chain, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structCatalog.html">Catalog</a> *catalog, struct <a class="el" href="structProposal.html">Proposal</a> **proposal, int NMAX)</td></tr>
<tr class="memdesc:a3ddfd1bbd97d07e4613528ed8fab7fd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up different proposals and assigns frequencies with which they are used. <br /></td></tr>
<tr class="separator:a3ddfd1bbd97d07e4613528ed8fab7fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54b00690393e59412f5945251abc6687" id="r_a54b00690393e59412f5945251abc6687"><td class="memItemLeft" align="right" valign="top"><a id="a54b00690393e59412f5945251abc6687" name="a54b00690393e59412f5945251abc6687"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>initialize_vb_proposal</b> (struct <a class="el" href="structOrbit.html">Orbit</a> *orbit, struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structPrior.html">Prior</a> *prior, struct <a class="el" href="structChain.html">Chain</a> *chain, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> **proposal, int NMAX)</td></tr>
<tr class="separator:a54b00690393e59412f5945251abc6687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a970c096c5428c06d08846a24c1e1c3d6" id="r_a970c096c5428c06d08846a24c1e1c3d6"><td class="memItemLeft" align="right" valign="top"><a id="a970c096c5428c06d08846a24c1e1c3d6" name="a970c096c5428c06d08846a24c1e1c3d6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup_fstatistic_proposal</b> (struct <a class="el" href="structOrbit.html">Orbit</a> *orbit, struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:a970c096c5428c06d08846a24c1e1c3d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up memory for and builds 3D histogram for F-statistics proposal. <br /></td></tr>
<tr class="separator:a970c096c5428c06d08846a24c1e1c3d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb78eb589bdad5cd8b1dd79953af9319" id="r_afb78eb589bdad5cd8b1dd79953af9319"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#afb78eb589bdad5cd8b1dd79953af9319">build_fstatistic_proposal</a> (struct <a class="el" href="structOrbit.html">Orbit</a> *orbit, struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:afb78eb589bdad5cd8b1dd79953af9319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create 3D histogram for F-statistics proposal.  <br /></td></tr>
<tr class="separator:afb78eb589bdad5cd8b1dd79953af9319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da7fb8f014c0e0879bf2fb77ec5aa04" id="r_a5da7fb8f014c0e0879bf2fb77ec5aa04"><td class="memItemLeft" align="right" valign="top"><a id="a5da7fb8f014c0e0879bf2fb77ec5aa04" name="a5da7fb8f014c0e0879bf2fb77ec5aa04"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rebuild_fstatistic_proposal</b> (struct <a class="el" href="structOrbit.html">Orbit</a> *orbit, struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:a5da7fb8f014c0e0879bf2fb77ec5aa04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rebuilds F-statistic proposal using current residual. <br /></td></tr>
<tr class="separator:a5da7fb8f014c0e0879bf2fb77ec5aa04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4d23d535092cc291b8c817e72177ecc" id="r_af4d23d535092cc291b8c817e72177ecc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af4d23d535092cc291b8c817e72177ecc">setup_prior_proposal</a> (struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structPrior.html">Prior</a> *prior, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:af4d23d535092cc291b8c817e72177ecc"><td class="mdescLeft">&#160;</td><td class="mdescRight">package priors into <a class="el" href="structProposal.html" title="Prototype structure for proposal distributions.">Proposal</a> structures  <br /></td></tr>
<tr class="separator:af4d23d535092cc291b8c817e72177ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f9f75e6e7010058dc7c5e35f53bcc6d" id="r_a3f9f75e6e7010058dc7c5e35f53bcc6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3f9f75e6e7010058dc7c5e35f53bcc6d">test_covariance_proposal</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structPrior.html">Prior</a> *prior, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, unsigned int *seed)</td></tr>
<tr class="memdesc:a3f9f75e6e7010058dc7c5e35f53bcc6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that covariance matrix proposal is properly normalized.  <br /></td></tr>
<tr class="separator:a3f9f75e6e7010058dc7c5e35f53bcc6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840df697159100dca6ef37caf4bf1db2" id="r_a840df697159100dca6ef37caf4bf1db2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840df697159100dca6ef37caf4bf1db2">setup_cdf_proposal</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, int NMAX)</td></tr>
<tr class="memdesc:a840df697159100dca6ef37caf4bf1db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores CDF of chain file input with &ndash;update flag.  <br /></td></tr>
<tr class="separator:a840df697159100dca6ef37caf4bf1db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5f91551300cbe59e301116e3abc9bf1" id="r_af5f91551300cbe59e301116e3abc9bf1"><td class="memItemLeft" align="right" valign="top"><a id="af5f91551300cbe59e301116e3abc9bf1" name="af5f91551300cbe59e301116e3abc9bf1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>setup_gmm_proposal</b> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structCatalog.html">Catalog</a> *catalog, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:af5f91551300cbe59e301116e3abc9bf1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies gaussian mixture model prior into proposal when given &ndash;update flag. <br /></td></tr>
<tr class="separator:af5f91551300cbe59e301116e3abc9bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb" id="r_a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb">setup_covariance_proposal</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structFlags.html">Flags</a> *flags, struct <a class="el" href="structProposal.html">Proposal</a> *proposal)</td></tr>
<tr class="memdesc:a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stores covariance matrices input with &ndash;update-cov flag.  <br /></td></tr>
<tr class="separator:a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaea7bf91a5ca99c7c29d1d6b7a8de12" id="r_aaaea7bf91a5ca99c7c29d1d6b7a8de12"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aaaea7bf91a5ca99c7c29d1d6b7a8de12">evaluate_fstatistic_proposal</a> (struct <a class="el" href="structData.html">Data</a> *data, UNUSED struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params)</td></tr>
<tr class="memdesc:aaaea7bf91a5ca99c7c29d1d6b7a8de12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns (log) F-statistic proposal density.  <br /></td></tr>
<tr class="separator:aaaea7bf91a5ca99c7c29d1d6b7a8de12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f21e5ccffef6a5f8ec8a83a41ec3077" id="r_a6f21e5ccffef6a5f8ec8a83a41ec3077"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6f21e5ccffef6a5f8ec8a83a41ec3077">uniform_prior_density</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params)</td></tr>
<tr class="memdesc:a6f21e5ccffef6a5f8ec8a83a41ec3077"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns (log) uniform prior density.  <br /></td></tr>
<tr class="separator:a6f21e5ccffef6a5f8ec8a83a41ec3077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42abc9fc4e637728c2206bc88601c3b" id="r_ad42abc9fc4e637728c2206bc88601c3b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad42abc9fc4e637728c2206bc88601c3b">prior_density</a> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params)</td></tr>
<tr class="memdesc:ad42abc9fc4e637728c2206bc88601c3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns (log) prior density.  <br /></td></tr>
<tr class="separator:ad42abc9fc4e637728c2206bc88601c3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22c52a307d7e75c874d19a12e56da44d" id="r_a22c52a307d7e75c874d19a12e56da44d"><td class="memItemLeft" align="right" valign="top"><a id="a22c52a307d7e75c874d19a12e56da44d" name="a22c52a307d7e75c874d19a12e56da44d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>gmm_prior_density</b> (struct <a class="el" href="structData.html">Data</a> *data, struct <a class="el" href="structModel.html">Model</a> *model, struct <a class="el" href="structSource.html">Source</a> *source, struct <a class="el" href="structProposal.html">Proposal</a> *proposal, double *params)</td></tr>
<tr class="memdesc:a22c52a307d7e75c874d19a12e56da44d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns (log) prior density of gaussian mixture model. <br /></td></tr>
<tr class="separator:a22c52a307d7e75c874d19a12e56da44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6411d0cd1ce0b0862365fa63ee9cd28f" id="r_a6411d0cd1ce0b0862365fa63ee9cd28f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6411d0cd1ce0b0862365fa63ee9cd28f">symmetric_density</a> (UNUSED struct <a class="el" href="structData.html">Data</a> *data, UNUSED struct <a class="el" href="structModel.html">Model</a> *model, UNUSED struct <a class="el" href="structSource.html">Source</a> *source, UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *proposal, UNUSED double *params)</td></tr>
<tr class="memdesc:a6411d0cd1ce0b0862365fa63ee9cd28f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Placeholder for symmetric proposal. Returns 0.0.  <br /></td></tr>
<tr class="separator:a6411d0cd1ce0b0862365fa63ee9cd28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions supporting proposal distributions. </p>
<p>Includes functions for generating new samples, evaluting proposal densities, and setup of specialized proposals using input data. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="afb78eb589bdad5cd8b1dd79953af9319" name="afb78eb589bdad5cd8b1dd79953af9319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb78eb589bdad5cd8b1dd79953af9319">&#9670;&#160;</a></span>build_fstatistic_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void build_fstatistic_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structOrbit.html">Orbit</a> *</td>          <td class="paramname"><span class="paramname"><em>orbit</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structFlags.html">Flags</a> *</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create 3D histogram for F-statistics proposal. </p>
<ul>
<li>discretize \({f_0,\cos\theta,\phi}\) space.<ul>
<li>frequency resolution is hard-coded to 1/4 of a bin</li>
<li>sky location resolution is hard-coded to 30x30 bins</li>
</ul>
</li>
<li>compute F-statistic in each cell of the grid</li>
<li>cap F-statistic at SNRmax=20</li>
<li>normalize to make it a proper proposal (this part is a pain to get right...)</li>
</ul>
<p>TODO: adaptive grid spacing based on Fisher sub-matrix </p>

</div>
</div>
<a id="a5299553c610fa57fe95527a5df181f22" name="a5299553c610fa57fe95527a5df181f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5299553c610fa57fe95527a5df181f22">&#9670;&#160;</a></span>cdf_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cdf_density </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate probability density from CDF. </p>
<p>Uses binary_search() to locate input params in CDF. Returns approximate value of PDF by taking numerical derivative of CDF on either side of input parameters. </p>

</div>
</div>
<a id="a48c97df4de6815daf57b7f054092a035" name="a48c97df4de6815daf57b7f054092a035"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48c97df4de6815daf57b7f054092a035">&#9670;&#160;</a></span>cov_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double cov_density </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate probability density of multimode, multivariate Gaussians given covariance matrices of each Gaussian and relative weights between them. </p>
<p>\( p = \sum_{m}^{\rm modes} {\rm weight}_m \frac{1}{(2\pi\det{\bf C}_m)^{D/2}} e^{-\frac{1}{2} \sum_i\sum_j \left(x_i - \bar{x}_{m,i}\right) C_{m,ij}^{-1} \left(x_j - \bar{x}_{m,j} \right) } \) </p>

</div>
</div>
<a id="ac00517700cc54a08f45110c55a73acfe" name="ac00517700cc54a08f45110c55a73acfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac00517700cc54a08f45110c55a73acfe">&#9670;&#160;</a></span>draw_calibration_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_calibration_parameters </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fair draw on phase and amplitude calibration parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model-&gt;calibration</td><td>(updates dampA,dampE) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = </dd></dl>

</div>
</div>
<a id="adaa7809385eb6fce342c65b98636adc3" name="adaa7809385eb6fce342c65b98636adc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaa7809385eb6fce342c65b98636adc3">&#9670;&#160;</a></span>draw_from_cdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_cdf </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw each parameter from 1D marginalized CDF. </p>
<p>Use CDFs constructed from chain file input at command line with &ndash;update flag to draw new parameters. The proposal draws a p-value from \(U[0,1]\) and interpolates the samples from the input chain file to find the associated parameter value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = <a class="el" href="#a5299553c610fa57fe95527a5df181f22" title="Evaluate probability density from CDF.">cdf_density()</a> </dd></dl>

</div>
</div>
<a id="ab7614272d932edceadfe55ad627c628d" name="ab7614272d932edceadfe55ad627c628d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7614272d932edceadfe55ad627c628d">&#9670;&#160;</a></span>draw_from_cov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_cov </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw from multivariate Gaussian characterized by chain covariance. </p>
<p>Use covariance matrices \( \bf{C}\) input at command line with &ndash;update_cov flag to draw new parameters. The covariance matrices are typically computed from already acquired chain files (e.g., from a previous run on less data).</p>
<p>The posteriors are bimodal so each source is represented by two multivariate Gaussians, one at each mode, characterized by the covariance matrix of the samples associated with each mode.</p>
<p>The proposal first randomly selects a source, then randomly selects a mode from the source. The proposed values are then computed using \( \vec\theta_y = \vec\theta_0 + {\bf L}\vec{n}\) where \( \vec{n} \) are fair draws from \( N[0,1]\), \( \vec\theta_0 \) are the mode centroids from the input chain, and \( {\bf}L \) is the LU decomposition of \( \bf{C} \).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = <a class="el" href="#a48c97df4de6815daf57b7f054092a035" title="Evaluate probability density of multimode, multivariate Gaussians given covariance matrices of each G...">cov_density()</a> </dd></dl>

</div>
</div>
<a id="a032470ab77fdc9e149c9e47b83772677" name="a032470ab77fdc9e149c9e47b83772677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a032470ab77fdc9e149c9e47b83772677">&#9670;&#160;</a></span>draw_from_extrinsic_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_extrinsic_prior </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fair draw from prior for location and orientation parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \({\cos\theta,\phi,\psi,\cos\iota,\varphi_0}\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = \(\ln p(\) <code>params</code> \()\) </dd></dl>

</div>
</div>
<a id="a4f62a5a745043ab5438665afd3d5696b" name="a4f62a5a745043ab5438665afd3d5696b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f62a5a745043ab5438665afd3d5696b">&#9670;&#160;</a></span>draw_from_fisher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_fisher </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Jump from current location along eigenvectors of Fisher information matrix. </p>
<p>Use precomputed Fisher matrix \( \Gamma_{ij} \equiv \langle \frac{\partial^2 h}{\partial \theta_i^2} \vert \frac{\partial^2 h}{\partial\theta_j^2} \rangle \) and center it at current parameters. Choose one eigenvector at random and propose a Gaussian jump along that direction scaled by the associated eigenvalue.</p>
<p>Jumps are conditioned against singular values, in which case the jump along that parameter direction is 0.01 the current value.</p>
<p>The proposal is assumed symmetric because the Fisher matrix is not being updated at each location.</p>
<p>The Fisher matrix is updated periodically during the MCMC.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = 0 (symmetric proposal) </dd></dl>

</div>
</div>
<a id="a3152614fb3711c8cbe2096aad5f034c6" name="a3152614fb3711c8cbe2096aad5f034c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3152614fb3711c8cbe2096aad5f034c6">&#9670;&#160;</a></span>draw_from_fstatistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_fstatistic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw from 3D F-statistic distribution. </p>
<p>Uses pre-computed 3D quantized distribution to draw \([f_0,\cos\theta,\phi]\) weighted by F-statistic likelihood in each cell. Remaining parameters are drawn from the prior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = <a class="el" href="#aaaea7bf91a5ca99c7c29d1d6b7a8de12" title="Returns (log) F-statistic proposal density.">evaluate_fstatistic_proposal()</a> </dd></dl>

</div>
</div>
<a id="a7a68e9374060cfd9ab81ea8129c9bc4b" name="a7a68e9374060cfd9ab81ea8129c9bc4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a68e9374060cfd9ab81ea8129c9bc4b">&#9670;&#160;</a></span>draw_from_galaxy_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_galaxy_prior </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structPrior.html">Prior</a> *</td>          <td class="paramname"><span class="paramname"><em>prior</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw sky location from galaxy prior defined in set_galaxy_prior() </p>
<p>Rejection samples sky location parameters \({\cos\theta,\phi}\) using galaxy-weighted sky prior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\cos\theta,\phi\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = prior-&gt;skyhist[] </dd></dl>

</div>
</div>
<a id="a33b2ee05338e6ddfa81600df5958407c" name="a33b2ee05338e6ddfa81600df5958407c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33b2ee05338e6ddfa81600df5958407c">&#9670;&#160;</a></span>draw_from_gmm_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_gmm_prior </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fair draw from gaussian mixture model prior for each parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = \(\ln p(\) <code>params</code> \()\) </dd></dl>

</div>
</div>
<a id="a3e0f672b1d0d0da33600eaf9d653169f" name="a3e0f672b1d0d0da33600eaf9d653169f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e0f672b1d0d0da33600eaf9d653169f">&#9670;&#160;</a></span>draw_from_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_prior </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fair draw from prior for each parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = \(\ln p(\) <code>params</code> \()\) </dd></dl>

</div>
</div>
<a id="a8162c698145d2a045bc76d3be0f29359" name="a8162c698145d2a045bc76d3be0f29359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8162c698145d2a045bc76d3be0f29359">&#9670;&#160;</a></span>draw_from_spectrum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_spectrum </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Draw \(f_0\) weighted by power spectrum of data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\mathcal{A}\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = 0 </dd></dl>

</div>
</div>
<a id="a915c8e096a29abba968df33c1fd7ba35" name="a915c8e096a29abba968df33c1fd7ba35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a915c8e096a29abba968df33c1fd7ba35">&#9670;&#160;</a></span>draw_from_uniform_prior()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double draw_from_uniform_prior </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fair draw from uniform ranges for each parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = \(\ln p(\) <code>params</code> \()\) </dd></dl>

</div>
</div>
<a id="aaaea7bf91a5ca99c7c29d1d6b7a8de12" name="aaaea7bf91a5ca99c7c29d1d6b7a8de12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaaea7bf91a5ca99c7c29d1d6b7a8de12">&#9670;&#160;</a></span>evaluate_fstatistic_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double evaluate_fstatistic_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns (log) F-statistic proposal density. </p>
<p>Find which cell of the \({f_0,\cos\theta,\phi}\) histogram contains the intput parameter values (params). Assembles joint proposal density from the 3D grid plus <a class="el" href="#ad42abc9fc4e637728c2206bc88601c3b" title="Returns (log) prior density.">prior_density()</a> for the remaining parameters. </p>

</div>
</div>
<a id="a1ffea32458788a4cdda74d645c31b15c" name="a1ffea32458788a4cdda74d645c31b15c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ffea32458788a4cdda74d645c31b15c">&#9670;&#160;</a></span>fm_shift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fm_shift </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shift \(f_0\) by orbital modulation frequency. </p>
<p>LISA's orbital motion induces secondary maxima spaced by the modulation frequency \(f_m = $1/{\rm year}\). This proposal shifts \(f_0\) by an integer multiple of \(f_m\) drawn from \(\text{floor}(N[0,1])\). Other parameters are either drawn from the Fisher matrix or from the prior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = 0 (symmetric proposal) </dd></dl>

</div>
</div>
<a id="aaf08661b50078f28351cbe2f6371a0ec" name="aaf08661b50078f28351cbe2f6371a0ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf08661b50078f28351cbe2f6371a0ec">&#9670;&#160;</a></span>jump_from_fstatistic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double jump_from_fstatistic </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Same as <a class="el" href="#a3152614fb3711c8cbe2096aad5f034c6" title="Draw from 3D F-statistic distribution.">draw_from_fstatistic()</a> with <a class="el" href="#a1ffea32458788a4cdda74d645c31b15c" title="Shift  by orbital modulation frequency.">fm_shift()</a> </p>
<p>Uses the same F-statistics proposal as <a class="el" href="#a3152614fb3711c8cbe2096aad5f034c6" title="Draw from 3D F-statistic distribution.">draw_from_fstatistic()</a> but randomly shifts \(f_0\) with <a class="el" href="#a1ffea32458788a4cdda74d645c31b15c" title="Shift  by orbital modulation frequency.">fm_shift()</a> instead of drawing \(f_0\) from prior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\vec\theta\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = <a class="el" href="#aaaea7bf91a5ca99c7c29d1d6b7a8de12" title="Returns (log) F-statistic proposal density.">evaluate_fstatistic_proposal()</a> </dd></dl>

</div>
</div>
<a id="ad42abc9fc4e637728c2206bc88601c3b" name="ad42abc9fc4e637728c2206bc88601c3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42abc9fc4e637728c2206bc88601c3b">&#9670;&#160;</a></span>prior_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double prior_density </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns (log) prior density. </p>
<p>Typically returns \(\sum \log\frac{1}{\Delta V}\) for each parameter except those that have non-trivial priors due to various run settings e.g., the SNR prior for \(\mathcal{A}\), or the galaxy prior for \({\cos\theta,\phi}\). </p>

</div>
</div>
<a id="a4f29a876611fbc4cffca0393f565ae10" name="a4f29a876611fbc4cffca0393f565ae10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f29a876611fbc4cffca0393f565ae10">&#9670;&#160;</a></span>psi_phi_jump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double psi_phi_jump </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Jumps between modes in \(\psi\)&ndash; \(\varphi_0\) plane. </p>
<p>For UCBs there is a perfect degeneracy between the polarization angle \(\psi\) and the initial phase \(\varphi_0\) at \( {\psi,\varphi_0} \rightarrow {\psi\pm\pi/2,\varphi_0\pm\pi} \). The sign of the shift depends on the inclination angle. This proposal chooses a scale for the jump \(\alpha = N[0,2\pi]\) and randomly chooses the sign of the proposal, then shifts \(\varphi_0\) and \(\psi\) by \(\alpha\) and \(\alpha/2\), respectively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">params</td><td>(updates \(\psi,\varphi_0\)) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>logQ = 0 (symmetric proposal) </dd></dl>

</div>
</div>
<a id="a840df697159100dca6ef37caf4bf1db2" name="a840df697159100dca6ef37caf4bf1db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840df697159100dca6ef37caf4bf1db2">&#9670;&#160;</a></span>setup_cdf_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_cdf_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structFlags.html">Flags</a> *</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>NMAX</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores CDF of chain file input with &ndash;update flag. </p>
<p>Reads chain file, sorts each marginalized distribution, and packages data into <a class="el" href="structProposal.html" title="Prototype structure for proposal distributions.">Proposal</a> structure. </p>

</div>
</div>
<a id="a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb" name="a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fa3b80b4bd6b1fb7fbf5ac35a28a2eb">&#9670;&#160;</a></span>setup_covariance_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_covariance_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structFlags.html">Flags</a> *</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stores covariance matrices input with &ndash;update-cov flag. </p>
<p>Reads covariance matrix files and parses weights, means, covariances, LU decompositions, and determinents. Inverts covariance matrix and packages data into proposal structure </p>

</div>
</div>
<a id="af4d23d535092cc291b8c817e72177ecc" name="af4d23d535092cc291b8c817e72177ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4d23d535092cc291b8c817e72177ecc">&#9670;&#160;</a></span>setup_prior_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_prior_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structFlags.html">Flags</a> *</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structPrior.html">Prior</a> *</td>          <td class="paramname"><span class="paramname"><em>prior</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>package priors into <a class="el" href="structProposal.html" title="Prototype structure for proposal distributions.">Proposal</a> structures </p>
<p>Allocates memory for using proposal structure to draw from prior. When the galaxy prior is used for \({\cos\theta,\phi}\) the data are stored in an unintuitive way so take a good look at source code. </p>

</div>
</div>
<a id="a6411d0cd1ce0b0862365fa63ee9cd28f" name="a6411d0cd1ce0b0862365fa63ee9cd28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6411d0cd1ce0b0862365fa63ee9cd28f">&#9670;&#160;</a></span>symmetric_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double symmetric_density </td>
          <td>(</td>
          <td class="paramtype">UNUSED struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Placeholder for symmetric proposal. Returns 0.0. </p>
<p>The <a class="el" href="structProposal.html" title="Prototype structure for proposal distributions.">Proposal</a> structure requires a proposal density function. This function serves that role for proposals which are symmetric and therefore do not need use any resources computing proposal densities that will just cancel in the Hastings ratio. </p>

</div>
</div>
<a id="a3f9f75e6e7010058dc7c5e35f53bcc6d" name="a3f9f75e6e7010058dc7c5e35f53bcc6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f9f75e6e7010058dc7c5e35f53bcc6d">&#9670;&#160;</a></span>test_covariance_proposal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void test_covariance_proposal </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structFlags.html">Flags</a> *</td>          <td class="paramname"><span class="paramname"><em>flags</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structPrior.html">Prior</a> *</td>          <td class="paramname"><span class="paramname"><em>prior</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>seed</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that covariance matrix proposal is properly normalized. </p>
<p>Monte Carlo integration of the covariance proposal rejection sampling on the prior boundaries. The matrices \(C_{ij}\) and \(L_{ij}\) are re-wighted to keep most of the proposal mass within the prior. </p>

</div>
</div>
<a id="a6f21e5ccffef6a5f8ec8a83a41ec3077" name="a6f21e5ccffef6a5f8ec8a83a41ec3077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f21e5ccffef6a5f8ec8a83a41ec3077">&#9670;&#160;</a></span>uniform_prior_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double uniform_prior_density </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structData.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>data</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structModel.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structSource.html">Source</a> *</td>          <td class="paramname"><span class="paramname"><em>source</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UNUSED struct <a class="el" href="structProposal.html">Proposal</a> *</td>          <td class="paramname"><span class="paramname"><em>proposal</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>params</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns (log) uniform prior density. </p>
<p>Returns \(\sum \log\frac{1}{\Delta V}\) for each parameter except the SNR prior for \(\mathcal{A}\). </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_85dbb6b122093deb312ddf7aa05a3747.html">ucb</a></li><li class="navelem"><a class="el" href="dir_2d82e0e57a5f5ab9b53c1fdbbc4d132a.html">src</a></li><li class="navelem"><a class="el" href="glass__ucb__proposal_8h.html">glass_ucb_proposal.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
